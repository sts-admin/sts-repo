<div ng-include="'templates/header.html'"></div>
<div ng-include="'templates/main-menu.html'"></div>
<div class="container-fluid">
  <div class="clearfix">
    <div class="panel panel-default" ng-init="jobVm.initJobOrderMasterInputs()">
      <div class="panel-heading form-heading panel-heading-top">
        <label>Job Order Report Input</label>
		<a id="form_display" class="btn btn-success pull-right" ng-click="jobVm.toggleReportFormVisibility();" href >{{jobVm.showReportForm?"Hide Report Form":"Show Report Form"}}</a> 
      </div>
      <div class="panel-body new-tk-bg">
        <form ng-submit="jobVm.rememberReportQueryParams();"  ng-show="jobVm.showReportForm">
        <!-- .row -->
        <section>
          <div class="container-fluid">
            <div class="row">
              <!-- .col -->
              <div style="font-size:14px;" class="col-lg-3 col-md-3 col-sm-3 text-center pad_top_30"> </div>
              <!-- .col -->
              <div class="col-lg-6 col-md-6 col-sm-6 text-right pad_bot_30"> </div>
            </div>
            <!-- .row -->
          </div>
          <!-- .container -->
          <form class="formular" action="" method="post" id="report_joborder" name="report_joborder">
            <div class="bg-F7EDF0 theme-form">
              <div class="container">
                <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 visible-xs-padding-right"> <span class="new-take-off-title"><u>Between Two Dates</u></span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 visible-xs-padding-right"> <span class="new-take-off-title">From:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-3 col-md-3 col-sm-2">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="From Date" uib-datepicker-popup="{{dateFormat}}" ng-model="jobVm.jobOrder.fromDate" is-open="jobVm.rptFromDate.opened" data-ng-click="jobVm.rptFromDatePicker()" datepicker-options="dateOptions" close-text="Close" close-on-date-selection="true" datepicker-append-to-body="true">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 visible-xs-padding-right"> <span class="new-take-off-title">To:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-3 col-md-3 col-sm-2">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="From Date" uib-datepicker-popup="{{dateFormat}}" ng-model="jobVm.jobOrder.toDate" is-open="jobVm.rptToDate.opened" data-ng-click="jobVm.rptToDatePicker()" datepicker-options="dateOptions" close-text="Close" close-on-date-selection="true" datepicker-append-to-body="true">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <hr>
                  </div>
                  <!-- .col -->
                </div>
                <!-- .row -->
                <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Year:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" ng-model="jobVm.jobOrder.year" 
				  ng-options="y.id as y.val for y in jobVm.rptYearRange">
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-1 col-xs-12"> <span class="new-take-off-title">Salesman:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select name="salesPersonId"   class="form-control"   
				  ng-model="jobVm.jobOrder.salesPersonId" 
				  ng-options="user.id as user.customName for user in jobVm.users" >
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-1 col-xs-12"> <span class="new-take-off-title">Usercode:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select name="salesPersonId"   class="form-control"   
				  ng-model="jobVm.jobOrder.createdByUserCode" 
				  ng-options="user.userCode as user.userCode for user in jobVm.users" >
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                </div>
                <!-- .row -->
                <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Engineer</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <select class="form-control"
				  ng-model="jobVm.jobOrder.engineerId" 
				  ng-options="engineer.id as engineer.name for engineer in jobVm.engineers" >
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Contractor</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" 
				  ng-model="jobVm.jobOrder.contractorId" 
				  ng-options="contractor.id as contractor.name for contractor in jobVm.contractors" >
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Architect</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" 
				  ng-model="jobVm.jobOrder.architectureId" 
				  ng-options="architect.id as architect.name for architect in jobVm.architects" >
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                </div>
                <!-- .row -->
                <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Final Update Status:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" ng-model="jobVm.jobOrder.finalUpdateStatus" 
				  ng-options="fs.id as fs.title for fs in jobVm.finalStatus">
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-1 col-xs-12"> <span class="new-take-off-title">Status:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" ng-model="jobVm.jobOrder.status" 
				  ng-options="js.id as js.title for js in jobVm.jobStatus">
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-1 col-xs-12"> <span class="new-take-off-title">View INV:</span> </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" ng-model="jobVm.jobOrder.invoiceMode" 
				  ng-options="i.id as i.title for i in jobVm.invoiceModes">
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                  <!-- .col -->
                </div>
                <!-- .row -->
                <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Job Status:</span> </div>
                  
                  <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="form-group">
                      <select class="form-control" ng-model="jobVm.jobOrder.jobStatus" 
				  ng-options="j.id as j.title for j in jobVm.jobStatuses">
                        <option value="">--- Select ---</option>
                      </select>
                    </div>
                  </div>
                </div>
				
				 <div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Job ID</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="Job ID" ng-model="jobVm.jobOrder.orderNumber">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Email Recepient Salesman</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
						<select name="salesPersonId"   class="form-control"   
							ng-model="jobVm.jobOrder.recepientSpId" 
							ng-options="user.id as user.customName for user in jobVm.users" >
							<option value="">--- Select ---</option>
						</select>
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Quote ID</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group"><input type="text" class="form-control" placeholder="Quote ID" ng-model="jobVm.jobOrder.quoteId">
                    </div>
                  </div>
                  <!-- .col -->
                </div>
				
				<div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Customer PO#</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="Customer PO" ng-model="jobVm.jobOrder.poName">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Job Name</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
						<input type="text" class="form-control" placeholder="Job Name" ng-model="jobVm.jobOrder.jobName">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Job Address</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group"><input type="text" class="form-control" placeholder="Job Address" ng-model="jobVm.jobOrder.jobAddress">
                    </div>
                  </div>
                  <!-- .col -->
                </div>
				
				
				<div class="row">
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Quoted Amount $</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="Quoted Amount" ng-model="jobVm.jobOrder.quotedAmount">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">Billing Amount $</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group">
						<input type="text" class="form-control" placeholder="Billing Amount" ng-model="jobVm.jobOrder.billingAmount">
                    </div>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-2 col-md-2 col-sm-3 col-xs-12"> <span class="new-take-off-title">VAV Controls</span> </div>
                  <!-- .col -->
                  <div class="col-lg-10 col-md-10 col-sm-8 col-xs-12">
                    <div class="form-group"><input type="text" class="form-control" placeholder="VAV Controls" ng-model="jobVm.jobOrder.vavControls">
                    </div>
                  </div>
                  <!-- .col -->
                </div>
				
                <!-- .row -->
                <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <hr>
                  </div>
                  <!-- .col -->
                  <div class="col-lg-12 col-md-12 col-sm-12 pad_top_301">
                    <input type="submit" class="submit-btn btn btn-primary" value="Generate" id="jobOrder-rpt-btn">
                    &nbsp;&nbsp;&nbsp;
                    <input type="reset" onclick="this.form.reset();" class="reset-btn btn btn-info" value="Reset">
                    <input type="hidden" value="search" name="search">
                  </div>
                  <!-- .col -->
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <hr>
                  </div>
                  <!-- .col -->
                </div>
                <!-- .row -->
              </div>
              <!-- .container -->
            </div>
            <!-- .bg-d0e9f4 -->
          </form>
          <div style="clear:both;"></div>
        </section>
        <!-- .row -->
        <!-- .row -->
        <div class="row checkrow"> </div>
        <!-- .row -->
        </form>
        
        <span id="jobOrder-rpt-spinner" style="display:none;">
			<img src="images/loading.gif" />
		</span>
		<div ng-show="jobVm.report.mode === 'output' ">
        <form class="table-container">
          <div style="margin-top:20px;">
            <table class="table-responsive theme-table" width="100%" cellspacing="0" cellpadding="0" border="1">
              <thead>
                <tr>
                  <td valign="top" colspan="12"><table width="100%" cellspacing="0" cellpadding="0" border="0">
                      <tbody>
                        <tr height="30">
                          <td width="11%" style="border:3px solid #D4A3B1;background:#BD7589; padding:5px;" class="table-header-repeat line-left minwidth-1">&nbsp; <strong>#JOBS FOUND :</strong></td>
                          <td width="7%" align="center" style="border:3px solid #D4A3B1; background:#090; padding:5px; color:#FFF;" class="table-header-repeat line-left minwidth-1"> {{jobVm.jobOrders?jobVm.jobOrders.length:0}} </td>
                          <td width="17%" align="center" style="border:3px solid #D4A3B1; background:#BD7589; padding:5px;" class="table-header-repeat line-left minwidth-1"><strong>TOTAL BILLING AMOUNT :</strong></td>
                          <td width="14%" align="center" style="border:3px solid #D4A3B1; background:#090; padding:5px; color:#FFF;" class="table-header-repeat line-left minwidth-1"><strong>{{jobVm.totalBillingAmount | currency}}</strong></td>
                          <td style="border:3px solid #D4A3B1;background:#BD7589; padding:5px;" class="table-header-repeat line-left minwidth-1"><strong>Total Profit :</strong></td>
                          <td style="border:3px solid #D4A3B1; padding:5px; background:#090; color:#FFF;" class="table-header-repeat line-left minwidth-1"><strong>{{jobVm.totalProfit | currency}}</strong></td>
                          <td style="border:3px solid #D4A3B1;background:#BD7589; padding:5px;" class="table-header-repeat line-left minwidth-1"><strong>Profit % :</strong></td>
                          <td style="border:3px solid #D4A3B1; padding:5px; background:#090; color:#FFF;" class="table-header-repeat line-left minwidth-1"><strong>{{jobVm.profitPercent}}</strong></td>
                        </tr>
                      </tbody>
                    </table></td>
                </tr>
                <tr>
                  <td colspan="10">&nbsp;</td>
                </tr>
                <tr style="background:#7D3549; color:#FFF;">
                  <td align="center">Info Icon</td>
                  <td align="center">ViewINV</td>
                  <td align="center">Start Date</td>
                  <td align="center" style="color:#FFF; background:#4D7373;">Quote</td>
                  <td align="center">Job ID</td>
                  <td align="center">Contractor</td>
                  <td align="center">Job name</td>
                  <td align="center">Address</td>
                  <td align="center">SP</td>
                  <td align="center">UC</td>
                  <td align="center">Billing Amount</td>
                </tr>
              </thead>
              <tbody>
                 <tr class ="gradeA" height="25" ng-repeat="jobOrder in jobVm.jobOrders track by $index" ng-style="{{jobOrder.statusStyle}}">
					  <td align="center">
						<span ng-show="jobOrder.takeoffId">
							<img  popover-placement="right" uib-popover-template="jobVm.takeoffInfoPopover.templateUrl" popover-trigger="'outsideClick'" popover-title="{{jobVm.takeoffInfoPopover.title}}"  ng-click="jobVm.showTakeoffInfo(jobOrder.takeoffId);"  style="cursor:pointer;" src="images/takeoffinfo.png" alt="image" border="0" />
							
						</span>
						<span ng-show="jobOrder.quoteId">
							<img  popover-placement="right" uib-popover-template="jobVm.quotePopover.templateUrl" popover-trigger="'outsideClick'" popover-title="{{jobVm.quotePopover.title}}"  ng-click="jobVm.showQuoteInfo(jobOrder.takeoffId);"  style="cursor:pointer;" src="images/quote_info.png" alt="image" border="0" />
						</span>
						
						<span ng-show="jobOrder.orderNumber">
							<img  popover-placement="right" uib-popover-template="jobVm.jobOrderPopover.templateUrl" popover-trigger="'outsideClick'" popover-title="{{jobVm.jobOrderPopover.title}}"  ng-click="jobVm.showJobOrderInfo(jobOrder);"  style="cursor:pointer;" src="images/jobinfo.png" alt="image" border="0" />
						</span>
					  </td>
                      
                      <td align="center">
						<span ng-show="jobOrder.invoiceMode === 'bill'">
							<a ng-show="!jobOrder.invoiceId" href ui-sref="bill-add({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber})">
								<img border="0" src="images/inv_status_bill.png">
							</a> 
							<a ng-show="jobOrder.invoiceId" href ui-sref="bill-edit({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber, invoiceId:jobOrder.invoiceId, activeTabIndex:0})">
								<img border="0" src="images/inv_status_bill.png">
							</a>
						</span>
						<span ng-show="jobOrder.invoiceMode === 'ptl'">
							<a ng-show="!jobOrder.invoiceId" href ui-sref="bill-add({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber})">
								<img border="0" src="images/inv_status_ptl.png">
							</a> 
							<a ng-show="jobOrder.invoiceId" href ui-sref="bill-edit({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber, invoiceId:jobOrder.invoiceId, activeTabIndex:0})">
								<img border="0" src="images/inv_status_ptl.png">
							</a>
						</span>
						<a ng-show="jobOrder.invoiceMode === 'inv'" href ui-sref="invoice-generate({invoiceOrderId:jobOrder.id})">
							<img border="0" src="images/inv_status_inv.png">
						</a>
					  </td>
                      <td align="center">{{jobOrder.dateCreated | date:'shortDate'}}</td>
						<td align="center">
							<a href ui-sref="quote-view" ng-show="jobOrder.quoteId">
								{{jobOrder.quoteId}}
							</a> 
							<span ng-show="!jobOrder.quoteId">...</span>
						</td>
                      <td align="center">
						<a ng-show="!jobOrder.invoiceId" href ui-sref="bill-add({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber})">{{jobOrder.orderNumber}}</a> 
						<a ng-show="jobOrder.invoiceId" href ui-sref="bill-edit({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber, invoiceId:jobOrder.invoiceId, activeTabIndex:0})">{{jobOrder.orderNumber}}</a>
					  </td>
                      <td align="center">
						<a href ui-sref="joborder-edit({id:jobOrder.id})" ng-show="jobOrder.id">
							{{jobOrder.contractorName?jobOrder.contractorName:'...'}}
						</a>
						<span ng-show="!jobOrder.id">...</span>
					  </td>
					  <td align="center">{{jobOrder.jobName?jobOrder.jobName:'...'}}</td>
                      <td align="center">{{jobOrder.jobAddress?jobOrder.jobAddress:'...'}}</td>
                      <td align="center"> {{jobOrder.salesPersonName?jobOrder.salesPersonName:'...'}} </td>
                      <td align="center"> {{jobOrder.createdByUserCode?jobOrder.createdByUserCode:'...'}} </td>
                      <td align="center"> 
						<a href ng-show="jobOrder.invoiceId && jobOrder.finalUpdate"  style="color:green;" ui-sref="bill-edit({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber, invoiceId:jobOrder.invoiceId, activeTabIndex:1})">
							{{jobOrder.billingAmount?jobOrder.billingAmount:'...' | currency}} 
						</a>
						<a href ng-show="jobOrder.invoiceId && !jobOrder.finalUpdate"  style="color:blue;" ui-sref="bill-edit({jobId:jobOrder.id, orderNumber:jobOrder.orderNumber, invoiceId:jobOrder.invoiceId, activeTabIndex:1})">
							{{jobOrder.billingAmount?jobOrder.billingAmount:'...' | currency}} 
						</a>
					  </td>
                    </tr>
              </tbody>
            </table>
          </div>
        </form>
		</div>
      </div>
    </div>
  </div>
</div>
<div style="clear:both;height:50px;"></div>
<div ng-include="'templates/footer.html'" ></div>
